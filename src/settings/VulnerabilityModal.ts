import { Modal } from "obsidian";

export class VulnerabilityModal extends Modal {
  private vulnerabilities: any[];

  constructor(app: any, vulnerabilities: any[]) {
    super(app);
    this.vulnerabilities = vulnerabilities;
  }

  onOpen() {
    const { contentEl } = this;

    contentEl.createEl("h2", { text: "Vulnérabilités OWASP WSTG" });

    this.vulnerabilities.forEach((vuln) => {
      const vulnEl = contentEl.createEl("div", { cls: "vulnerability-item" });
      vulnEl.createEl("h3", { text: vuln.name });
      vulnEl.createEl("p", { text: `Description: ${vuln.description}` });
      vulnEl.createEl("p", { text: `CVSS: ${vuln.cvss}` });
    });
  }

  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
}
